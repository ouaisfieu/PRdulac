<!-- index.html ‚Äî RECRUTEMENT ‚ÄúPr. du Lac‚Äù (anonymis√©) ‚Ä¢ 100% statique ‚Ä¢ WOW + viral hooks -->
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="color-scheme" content="dark light"/>
  <title>Pr. du Lac ‚Äî Recrutement (dossier anonymis√©)</title>
  <meta name="description" content="Dossier anonymis√© + landing de recrutement : mission, preuves, timeline, quiz, partage, candidature."/>
  <meta name="theme-color" content="#0b0f1f"/>

  <!-- Open Graph -->
  <meta property="og:title" content="Pr. du Lac ‚Äî On recrute une DG / strat√®ge (anonymis√©)"/>
  <meta property="og:description" content="Landing + dossier : preuves, timeline, quiz, et candidature. Statique, publish-ready."/>
  <meta property="og:type" content="website"/>
  <!-- Ajoute un og:image local si tu veux: assets/og.png -->
  <meta property="og:image" content="assets/og.png"/>
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Pr. du Lac ‚Äî Recrutement (anonymis√©)"/>
  <meta name="twitter:description" content="Mission, preuves, quiz, et candidature. Statique et viral."/>
  <meta name="twitter:image" content="assets/og.png"/>

  <!-- Minimal JSON-LD (no personal identity) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"Recrutement ‚Äî Pr. du Lac (anonymis√©)",
    "description":"Landing de recrutement + dossier documentaire anonymis√©.",
    "inLanguage":"fr"
  }
  </script>

  <style>
    :root{
      --bg:#070a14; --bg2:#0b1024; --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.04);
      --line: rgba(255,255,255,.12);
      --text:#eaf0ff; --muted:#a7b2d6; --faint:#7e88b6;
      --accent:#7c5cff; --accent2:#32d6ff; --good:#3df0a8; --warn:#ffcc66; --bad:#ff5c7a;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --r: 20px; --r2: 28px;
      --shadow: 0 22px 100px rgba(0,0,0,.45);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff; --bg2:#eef2ff; --panel: rgba(10,16,36,.05);
        --panel2: rgba(10,16,36,.03);
        --line: rgba(10,16,36,.12);
        --text:#0a1024; --muted:#2b3968; --faint:#52609a;
        --shadow: 0 22px 90px rgba(10,16,36,.14);
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1000px 700px at 10% -10%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(1000px 700px at 110% 10%, rgba(50,214,255,.25), transparent 55%),
        radial-gradient(900px 650px at 50% 120%, rgba(61,240,168,.14), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      overflow-x:hidden;
    }
    a{color:inherit}
    .noise{
      pointer-events:none;
      position:fixed; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.24'/%3E%3C/svg%3E");
      opacity:.09;
      mix-blend-mode: overlay;
    }
    .bg-anim{
      position:fixed; inset:-50px;
      background:
        radial-gradient(420px 280px at 20% 30%, rgba(124,92,255,.22), transparent 60%),
        radial-gradient(420px 280px at 70% 20%, rgba(50,214,255,.18), transparent 60%),
        radial-gradient(420px 280px at 60% 70%, rgba(61,240,168,.10), transparent 60%);
      filter: blur(10px);
      opacity:.7;
      animation: drift 18s ease-in-out infinite alternate;
      pointer-events:none;
    }
    @keyframes drift{
      0%{transform: translate3d(-10px,-10px,0) scale(1)}
      100%{transform: translate3d(14px,16px,0) scale(1.02)}
    }

    /* Topbar */
    .topbar{
      position:sticky; top:0; z-index:50;
      backdrop-filter: blur(14px);
      background: linear-gradient(180deg, rgba(8,10,18,.78), rgba(8,10,18,.34));
      border-bottom:1px solid var(--line);
    }
    @media (prefers-color-scheme: light){
      .topbar{background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.55));}
    }
    .topbar .inner{
      max-width: 1280px;
      margin:0 auto;
      padding: 12px 16px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .brand{
      display:flex; gap:10px; align-items:center;
      min-width: 260px;
    }
    .logo{
      width:42px; height:42px;
      border-radius: 16px;
      background:
        radial-gradient(16px 16px at 30% 30%, rgba(255,255,255,.38), transparent 60%),
        conic-gradient(from 180deg, var(--accent), var(--accent2), var(--good), var(--accent));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 60px rgba(124,92,255,.22);
      position:relative;
    }
    .logo:after{
      content:"";
      position:absolute; inset:10px;
      border-radius: 12px;
      background: rgba(10,14,26,.35);
      border: 1px solid rgba(255,255,255,.10);
    }
    @media (prefers-color-scheme: light){
      .logo:after{background: rgba(255,255,255,.52)}
    }
    .brand h1{margin:0;font-size:14px;letter-spacing:.3px}
    .brand .sub{font-size:12px;color:var(--muted);margin-top:2px}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      font-size:12px; color: var(--muted);
      border:1px solid var(--line);
      background: var(--panel);
      padding: 8px 10px;
      border-radius: 999px;
      white-space:nowrap;
    }
    .dot{width:9px;height:9px;border-radius:999px;background:var(--good);box-shadow:0 0 0 3px rgba(61,240,168,.16)}
    .mono{font-family:var(--mono)}
    .search{
      flex:1;
      display:flex; align-items:center; gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: var(--panel);
      box-shadow: 0 20px 80px rgba(0,0,0,.18);
      min-width: 160px;
    }
    .search input{
      width:100%;
      border:none; outline:none;
      background:transparent;
      color:var(--text);
      font-size: 13px;
    }
    .kbd{
      font-family:var(--mono);
      font-size:11px;
      color: var(--faint);
      padding: 4px 7px;
      border-radius: 10px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.16);
    }
    @media (prefers-color-scheme: light){
      .kbd{background: rgba(10,16,36,.06)}
    }
    .btn{
      cursor:pointer;
      user-select:none;
      border:none;
      color: var(--text);
      background: var(--panel);
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 10px 12px;
      font-size: 12px;
      display:inline-flex; gap:8px; align-items:center;
      transition: transform .08s ease, border-color .15s ease, background .15s ease, box-shadow .15s ease;
    }
    .btn:hover{transform: translateY(-1px); border-color: rgba(124,92,255,.55)}
    .btn:active{transform: translateY(0)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(124,92,255,.28), rgba(50,214,255,.20));
      border-color: rgba(124,92,255,.55);
      box-shadow: 0 18px 70px rgba(124,92,255,.16);
    }
    .btn.good{border-color: rgba(61,240,168,.45)}
    .btn.bad{border-color: rgba(255,92,122,.45)}
    .btn:focus{outline: 2px solid rgba(50,214,255,.35); outline-offset: 2px}

    /* Layout */
    .wrap{
      max-width: 1280px;
      margin:0 auto;
      padding: 18px 16px 40px;
      display:grid;
      gap:14px;
      grid-template-columns: 1.15fr .85fr;
      align-items:start;
    }
    @media (max-width: 1020px){ .wrap{grid-template-columns: 1fr} }

    .hero{
      border-radius: var(--r2);
      border:1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-1px;
      background:
        radial-gradient(800px 340px at 20% 0%, rgba(124,92,255,.20), transparent 60%),
        radial-gradient(800px 340px at 90% 10%, rgba(50,214,255,.16), transparent 60%),
        radial-gradient(800px 380px at 70% 120%, rgba(61,240,168,.10), transparent 60%);
      pointer-events:none;
      opacity:.8;
    }
    .hero .inner{
      position:relative;
      padding: 22px 18px 18px;
      display:grid;
      gap:14px;
      grid-template-columns: 1.2fr .8fr;
      align-items:start;
    }
    @media (max-width: 820px){ .hero .inner{grid-template-columns: 1fr} }

    .h-title{
      margin:0;
      font-size: 22px;
      letter-spacing:.2px;
      line-height: 1.15;
    }
    .h-sub{
      margin:8px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.55rem;
    }
    .ctaRow{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
    .chip{
      font-size:11px;
      color: var(--muted);
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding: 7px 9px;
      border-radius: 999px;
    }
    .chip strong{color: var(--text); font-weight:600}

    .sideCard{
      border-radius: var(--r2);
      border:1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHd{
      padding: 14px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
    }
    @media (prefers-color-scheme: light){
      .cardHd{border-bottom:1px solid rgba(10,16,36,.10)}
    }
    .cardHd h2{
      margin:0;
      font-size: 13px;
      letter-spacing:.2px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .cardHd p{
      margin: 4px 0 0;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.35rem;
    }
    .cardBd{padding: 12px 14px 14px}
    .grid3{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px}
    @media (max-width: 1020px){ .grid3{grid-template-columns: repeat(2, 1fr)} }
    @media (max-width: 560px){ .grid3{grid-template-columns: 1fr} }

    .kpi{
      border-radius: 18px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding: 10px;
      min-height: 76px;
    }
    .kpi .n{font-family:var(--mono);font-size:18px}
    .kpi .l{margin-top:6px;font-size:11px;color:var(--faint)}
    .kpi .b{margin-top:6px;font-size:12px;color:var(--muted);line-height:1.25rem}

    /* Feed */
    .section{
      border-radius: var(--r2);
      border:1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .ticker{
      display:flex; gap:12px; align-items:center;
      padding: 10px 14px;
      border-top:1px solid rgba(255,255,255,.10);
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
    }
    @media (prefers-color-scheme: light){
      .ticker{border-top:1px solid rgba(10,16,36,.10);border-bottom:1px solid rgba(10,16,36,.10)}
    }
    .ticker strong{font-size:12px}
    .marq{white-space:nowrap; font-size:12px; color:var(--muted); animation: marq 30s linear infinite}
    @keyframes marq{0%{transform:translateX(0)}100%{transform:translateX(-55%)}}

    .feed{display:flex; flex-direction:column; gap:10px}
    .story{
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      overflow:hidden;
      transition: transform .10s ease, border-color .15s ease;
    }
    @media (prefers-color-scheme: light){
      .story{border:1px solid rgba(10,16,36,.12); background: rgba(10,16,36,.03)}
    }
    .story:hover{transform: translateY(-1px); border-color: rgba(124,92,255,.45)}
    .shd{padding: 12px 12px 8px; display:flex; gap:10px; align-items:flex-start}
    .badge{
      font-family:var(--mono);
      font-size:11px;
      padding: 6px 8px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      white-space:nowrap;
    }
    @media (prefers-color-scheme: light){
      .badge{background: rgba(10,16,36,.05);border:1px solid rgba(10,16,36,.10)}
    }
    .badge.breaking{border-color: rgba(255,92,122,.55); color: var(--text)}
    .badge.proof{border-color: rgba(61,240,168,.45); color: var(--text)}
    .story h3{margin:0; font-size: 13px; line-height: 1.25rem}
    .meta{margin-top:6px; display:flex; flex-wrap:wrap; gap:8px; font-size:11px; color:var(--faint); font-family:var(--mono)}
    .txt{
      padding: 0 12px 10px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.5rem;
    }
    .actions{
      padding: 10px 12px 12px;
      border-top:1px dashed rgba(255,255,255,.14);
      display:flex; flex-wrap:wrap; gap:10px;
    }
    @media (prefers-color-scheme: light){
      .actions{border-top:1px dashed rgba(10,16,36,.10)}
    }

    /* Viewer + modal */
    .viewer{
      border-radius: var(--r2);
      border:1px solid var(--line);
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:sticky;
      top: 86px;
      max-height: calc(100vh - 110px);
      display:flex;
      flex-direction:column;
    }
    @media (max-width: 1020px){
      .viewer{position:relative; top:auto; max-height:none}
    }
    .viewer .body{padding: 14px; overflow:auto}
    .hr{height:1px; background: rgba(255,255,255,.10); margin: 12px 0}
    @media (prefers-color-scheme: light){
      .hr{background: rgba(10,16,36,.10)}
    }

    .notice{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 18px;
      padding: 10px 12px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.4rem;
    }
    .notice strong{color: var(--text)}
    .content{
      font-size: 13.5px;
      line-height: 1.65rem;
    }
    .content p{margin: 0 0 10px}
    .content h3{margin: 12px 0 8px; font-size: 14px}
    .content ul{margin: 6px 0 10px 18px}
    .content li{margin: 4px 0}
    .content code{font-family: var(--mono)}
    .content pre{
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding: 12px;
      overflow:auto;
    }
    @media (prefers-color-scheme: light){
      .content pre{background: rgba(10,16,36,.04);border:1px solid rgba(10,16,36,.10)}
    }

    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,.6);
      z-index: 200;
      padding: 14px;
    }
    .modal.open{display:flex}
    .mcard{
      width: min(1120px, 100%);
      max-height: 92vh;
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(12,16,32,.92);
      backdrop-filter: blur(18px);
      box-shadow: 0 24px 110px rgba(0,0,0,.6);
      overflow:hidden;
    }
    @media (prefers-color-scheme: light){
      .mcard{background: rgba(255,255,255,.92); border:1px solid rgba(10,16,36,.12)}
    }
    .mhd{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    @media (prefers-color-scheme: light){
      .mhd{border-bottom:1px solid rgba(10,16,36,.10)}
    }
    .mhd h4{margin:0;font-size:13px}
    .mhd p{margin:2px 0 0;color:var(--muted);font-size:11.5px}
    .mbd{padding: 12px; overflow:auto; max-height: calc(92vh - 56px)}
    iframe.embed, iframe.sandbox{
      width:100%;
      height: 72vh;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: white;
    }

    /* Viral widgets */
    .viralRow{display:flex; gap:10px; flex-wrap:wrap}
    .shareBox{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 18px;
      padding: 10px;
      display:flex; flex-direction:column; gap:10px;
    }
    .field{
      display:flex; gap:10px; flex-wrap:wrap;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding: 10px;
      align-items:center;
    }
    .field input, .field textarea{
      flex:1;
      min-width: 220px;
      border:none; outline:none;
      background: transparent;
      color: var(--text);
      font-size: 12.5px;
      line-height: 1.35rem;
      font-family: var(--sans);
      resize: vertical;
    }
    .small{font-size:11px;color:var(--faint);font-family:var(--mono)}
    .quiz{
      display:grid;
      gap:10px;
    }
    .q{
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 18px;
      padding: 10px;
    }
    .q strong{display:block;font-size:12px}
    .opt{margin-top:8px; display:grid; gap:8px}
    .opt button{
      text-align:left;
      padding: 10px 10px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
      color: var(--text);
      cursor:pointer;
      transition: transform .08s ease, border-color .15s ease;
      font-size: 12px;
    }
    @media (prefers-color-scheme: light){
      .opt button{background: rgba(10,16,36,.05); border:1px solid rgba(10,16,36,.10)}
    }
    .opt button:hover{transform: translateY(-1px); border-color: rgba(50,214,255,.45)}
    .score{
      display:flex; justify-content:space-between; gap:10px; align-items:center;
      border:1px solid var(--line);
      background: linear-gradient(135deg, rgba(124,92,255,.16), rgba(50,214,255,.10));
      border-radius: 18px;
      padding: 10px;
    }
    .score .n{font-family:var(--mono);font-size:18px}
    .footer{
      max-width: 1280px;
      margin: 0 auto;
      padding: 18px 16px 40px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45rem;
    }
    .divider{height:1px;background:rgba(255,255,255,.10);margin:16px 0}
    @media (prefers-color-scheme: light){
      .divider{background: rgba(10,16,36,.10)}
    }
  </style>
</head>

<body>
  <div class="bg-anim" aria-hidden="true"></div>
  <div class="noise" aria-hidden="true"></div>

  <header class="topbar">
    <div class="inner">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div style="min-width:0">
          <h1>RECRUTEMENT ‚Äî Pr. du Lac <span class="mono" style="opacity:.75">[anonymis√©]</span></h1>
          <div class="sub">Landing viral + dossier documentaire ‚Ä¢ statique ‚Ä¢ publish-ready</div>
        </div>
      </div>

      <div class="pill"><span class="dot"></span><span>LIVE</span><span class="mono" id="clock"></span></div>

      <div class="search" role="search" aria-label="Recherche">
        <span class="mono" style="opacity:.7">‚åï</span>
        <input id="q" placeholder="Rechercher : comp√©tences, timeline, preuves, tags‚Ä¶" />
        <span class="kbd" title="Raccourci">/</span>
      </div>

      <button class="btn primary" id="btnOpenPdf">Ouvrir PDF</button>
      <button class="btn" id="btnCopyLink">Copier lien</button>
    </div>
  </header>

  <main class="wrap">
    <!-- Left column -->
    <section>
      <div class="hero">
        <div class="inner">
          <div>
            <h2 class="h-title">On recrute un profil rare : strat√©gie sociale + gouvernance + terrain.</h2>
            <p class="h-sub">
              Ce site est un <strong>dossier anonymis√©</strong> et une landing de <strong>recrutement</strong>.
              Il met en avant un parcours ‚Äúpilier social / √©ducation permanente / action sociale‚Äù et une capacit√© √† tenir la barre en contexte public et tendu.
              <span class="small">Sources internes du dossier : PDF anonymis√©.</span>
            </p>

            <div class="chips" id="chips">
              <!-- injected -->
            </div>

            <div class="ctaRow">
              <button class="btn primary good" id="btnStart">‚ö° D√©marrer le pitch</button>
              <button class="btn" id="btnQuiz">üß™ Test ‚Äúfit mission‚Äù</button>
              <button class="btn" id="btnCandidater">‚úâÔ∏è Candidater</button>
              <button class="btn" id="btnExport">‚¨áÔ∏é Export kit</button>
            </div>
          </div>

          <div class="shareBox">
            <div class="small">‚öôÔ∏è Viral hooks (pr√™ts)</div>

            <div class="viralRow">
              <button class="btn primary" id="btnShare">Partager</button>
              <button class="btn" id="btnMakeClip">G√©n√©rer post</button>
              <button class="btn" id="btnReveal">Mode ‚ÄúWOW‚Äù</button>
            </div>

            <div class="field">
              <input id="shareText" value="On recrute Pr. du Lac (anonymis√©) ‚Äî profil DG/strat√®ge social¬∑e. Dossier + preuves + quiz." />
              <button class="btn" id="btnCopyPost">Copier</button>
            </div>

            <div class="notice">
              <strong>√âthique:</strong> aucun √©l√©ment d‚Äôidentit√© priv√©e n‚Äôest publi√© ici. Tout reste au niveau ‚Äúprofil & preuves‚Äù anonymis√©es.
            </div>
          </div>
        </div>

        <div class="ticker">
          <strong class="mono">FLASH</strong>
          <div class="marq" id="marq">
            ‚Ä¢ Dossier anonymis√© ‚Ä¢ Gouvernance partag√©e ‚Ä¢ Prises de parole publiques ‚Ä¢ √âducation permanente ‚Ä¢ Action sociale d‚Äôurgence ‚Ä¢
            Campagnes justice sociale ‚Ä¢ ‚ÄúRien sur moi, sans moi‚Äù ‚Ä¢
          </div>
        </div>
      </div>

      <div class="section" style="margin-top:14px">
        <div class="cardHd">
          <div style="min-width:0">
            <h2>Fil ‚Äúpreuves & comp√©tences‚Äù</h2>
            <p>Stories courtes, partageables, et ancr√©es dans le dossier.</p>
          </div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end">
            <button class="btn" id="btnOnlyProof">Preuves</button>
            <button class="btn" id="btnOnlyBreaking">Breaking</button>
            <button class="btn" id="btnReset">Reset</button>
          </div>
        </div>
        <div class="cardBd">
          <div class="feed" id="feed"></div>
        </div>
      </div>

      <div class="section" style="margin-top:14px">
        <div class="cardHd">
          <div style="min-width:0">
            <h2>Quiz ‚Äúfit mission‚Äù</h2>
            <p>Un mini-test pour g√©n√©rer engagement + self-selection (et partage).</p>
          </div>
          <button class="btn primary" id="btnQuiz2">Lancer</button>
        </div>
        <div class="cardBd">
          <div class="quiz" id="quiz"></div>
          <div class="score" style="margin-top:10px">
            <div>
              <div class="small">Score</div>
              <div class="n" id="scoreN">0</div>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end">
              <button class="btn" id="btnCopyScore">Copier r√©sultat</button>
              <button class="btn primary" id="btnShareScore">Partager r√©sultat</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Right column -->
    <aside class="viewer">
      <div class="cardHd">
        <div style="min-width:0">
          <h2 id="viewTitle">Lecteur</h2>
          <p id="viewSub">S√©lectionne une story. Ou ouvre le PDF anonymis√©.</p>
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end">
          <button class="btn" id="btnRedact">Redact</button>
          <button class="btn bad" id="btnClear">Clear</button>
        </div>
      </div>
      <div class="body">
        <div class="grid3" id="kpis">
          <div class="kpi"><div class="n" id="kStories">‚Äî</div><div class="l">stories</div><div class="b">fil √©ditorial</div></div>
          <div class="kpi"><div class="n" id="kTags">‚Äî</div><div class="l">tags</div><div class="b">tri instantan√©</div></div>
          <div class="kpi"><div class="n" id="kProof">‚Äî</div><div class="l">preuves</div><div class="b">stories ‚Äúancr√©es‚Äù</div></div>
        </div>

        <div class="hr"></div>

        <div class="notice">
          <strong>Base du dossier (anonymis√©)</strong> : parcours associatif, √©ducation permanente, action sociale, prise de parole publique,
          gouvernance partag√©e, et transition vers la direction d‚Äôune structure d‚Äôurgence sociale. (Source : PDF anonymis√©)
        </div>

        <div class="hr"></div>

        <div class="content" id="content">
          <h3>Mode d‚Äôemploi</h3>
          <ul>
            <li>Utilise <strong>Partager</strong> pour d√©clencher la viralit√© (Web Share si dispo).</li>
            <li>Utilise <strong>G√©n√©rer post</strong> pour fabriquer une publication pr√™te √† coller (LinkedIn/Bluesky/Mastodon/X).</li>
            <li>Utilise <strong>Candidater</strong> pour g√©n√©rer un email propre et un mini-dossier t√©l√©chargeable.</li>
          </ul>
          <p class="small">Aucune donn√©e d‚Äôidentit√© n‚Äôest expos√©e ici : uniquement un profil anonymis√©.</p>
        </div>

        <div class="hr"></div>

        <div class="notice">
          <strong>Fichier PDF</strong> attendu √† la racine : <span class="mono">anonymised.pdf</span>
          <div class="small" style="margin-top:6px">Tu peux le renommer ou modifier la constante <span class="mono">PDF_PATH</span> dans le script.</div>
        </div>
      </div>
    </aside>
  </main>

  <footer class="footer">
    <div class="divider"></div>
    <div class="small">
      ¬© Site statique ‚Äî Recrutement anonymis√© (Pr. du Lac).
      <br/>Note: Les √©l√©ments ‚Äúpreuves‚Äù sont structur√©s √† partir du dossier PDF anonymis√©. Aucun √©l√©ment d‚Äôidentit√© priv√©e n‚Äôest publi√©.
    </div>
  </footer>

  <!-- Modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="Contenu">
    <div class="mcard">
      <div class="mhd">
        <div>
          <h4 id="mTitle">‚Äî</h4>
          <p id="mSub">‚Äî</p>
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap">
          <button class="btn" id="mCopy">Copier</button>
          <button class="btn" id="mDownload">T√©l√©charger</button>
          <button class="btn bad" id="mClose">Fermer</button>
        </div>
      </div>
      <div class="mbd" id="mBody"></div>
    </div>
  </div>

  <script>
  (() => {
    const PDF_PATH = "anonymised.pdf"; // mets ton fichier √† la racine du dossier
    const BRAND_TAGS = [
      "DG / direction", "√©ducation permanente", "action sociale", "gouvernance", "strat√©gie", "plaidoyer",
      "droits sociaux", "solidarit√©", "terrain", "crise & budgets", "communication", "coalitions"
    ];

    // ‚ÄúStories‚Äù structur√©es √† partir du dossier PDF anonymis√© (sans d√©tails identifiants)
    // Source: PDF anonymis√© du profil ‚ÄúPr. du Lac‚Äù (parcours, engagements, contributions). (Voir le fichier)
    const STORIES = [
      {
        id: uid(), ts: Date.now() - 1000*60*24,
        badge: "BREAKING", breaking: true, proof: false,
        title: "On recrute : profil DG / strat√®ge social¬∑e (anonymis√©)",
        tags: ["recrutement", "direction", "mission"],
        body:
`Objectif : recruter un profil rare capable de tenir ensemble :
- vision politique & sociale,
- gouvernance et cr√©dibilit√© institutionnelle,
- et action concr√®te sur le terrain.

Ce site = landing + dossier anonymis√© + m√©canismes viraux (posts, partage, quiz).`
      },
      {
        id: uid(), ts: Date.now() - 1000*60*40,
        badge: "PREUVE", breaking: false, proof: true,
        title: "Parcours 360¬∞ : associatif, syndical, mutualiste, puis urgence sociale",
        tags: ["parcours", "terrain", "strat√©gie"],
        body:
`Le dossier d√©crit un parcours long dans le secteur associatif, avec un passage par la recherche syndicale,
puis des responsabilit√©s de direction dans l‚Äô√©ducation permanente, et une transition vers la direction d‚Äôune structure d‚Äôurgence sociale.
=> Pattern : capacit√© √† naviguer entre analyse, gouvernance, et mise en ≈ìuvre.`
      },
      {
        id: uid(), ts: Date.now() - 1000*60*58,
        badge: "PREUVE", breaking: false, proof: true,
        title: "Gouvernance partag√©e : codirection, partage du pouvoir, continuit√© + modernisation",
        tags: ["gouvernance", "management", "culture orga"],
        body:
`Le dossier met en avant une logique de codirection et de gouvernance partag√©e :
- compl√©mentarit√©,
- responsabilisation,
- et modernisation des pratiques.
=> Signal ‚Äúanti-ego‚Äù, utile quand l‚Äôinstitution est sous tension.`
      },
      {
        id: uid(), ts: Date.now() - 1000*60*75,
        badge: "INFO", breaking: false, proof: false,
        title: "Comp√©tence cl√© : parler public sans se faire manger vivant",
        tags: ["communication", "n√©gociation", "crise"],
        body:
`Le dossier mentionne des √©pisodes de d√©bat public tendu autour de l‚Äô√©ducation permanente et des financements.
=> Traduction recrutement : sang-froid, cadrage, et capacit√© √† d√©fendre une ligne sans perdre l‚Äôinstitution.`
      },
      {
        id: uid(), ts: Date.now() - 1000*60*96,
        badge: "PREUVE", breaking: false, proof: true,
        title: "Plaidoyer : alliances larges + campagnes justice sociale",
        tags: ["plaidoyer", "coalitions", "droits sociaux"],
        body:
`Le dossier souligne une capacit√© √† f√©d√©rer au-del√† d‚Äôun seul camp :
coalitions, campagnes, alliances entre r√©seaux.
=> Traduction recrutement : cr√©er une majorit√© sociale, pas juste des id√©es.`
      },
      {
        id: uid(), ts: Date.now() - 1000*60*120,
        badge: "INFO", breaking: false, proof: false,
        title: "Ligne directrice : dignit√©, participation, ‚Äúrien sur moi sans moi‚Äù",
        tags: ["√©thique", "participation", "terrain"],
        body:
`Le dossier insiste sur une approche humaniste + syst√©mique :
- dignit√©,
- participation des personnes concern√©es,
- et lucidit√© budg√©taire.
=> Traduction recrutement : pas du storytelling, une doctrine de pilotage.`
      }
    ];

    // Quiz (viral, self-selection)
    const QUIZ = [
      {
        q: "Tu veux une DG qui‚Ä¶",
        opts: [
          {t:"g√®re un budget en silence, sans d√©ranger personne", v:0},
          {t:"assume le conflit public quand il faut, sans cramer l‚Äôinstitution", v:2},
          {t:"fait du branding sans toucher au terrain", v:0}
        ]
      },
      {
        q: "En crise (m√©dias + politique), tu privil√©gies‚Ä¶",
        opts: [
          {t:"la transparence cadr√©e + des preuves + une ligne simple", v:2},
          {t:"le flou artistique pour passer entre les gouttes", v:0},
          {t:"le clash permanent sur les r√©seaux", v:1}
        ]
      },
      {
        q: "Tu veux une direction qui‚Ä¶",
        opts: [
          {t:"centralise tout (one boss)", v:0},
          {t:"organise une gouvernance partag√©e et robuste", v:2},
          {t:"d√©l√®gue sans jamais rendre de comptes", v:0}
        ]
      },
      {
        q: "Pour l‚Äôimpact social, tu crois surtout √†‚Ä¶",
        opts: [
          {t:"l‚Äôaction d‚Äôurgence + l‚Äô√©coute des publics + le long terme", v:2},
          {t:"les slogans et le storytelling", v:0},
          {t:"la pure technique sans politique", v:0}
        ]
      }
    ];

    const state = {
      onlyProof: false,
      onlyBreaking: false,
      query: "",
      score: 0,
      wow: false
    };

    // DOM
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));

    // Clock
    setInterval(()=> $("#clock").textContent = new Date().toLocaleTimeString(undefined,{hour:"2-digit",minute:"2-digit",second:"2-digit"}), 250);

    // Init UI
    renderChips();
    renderFeed();
    renderKPIs();
    renderQuiz();

    // Bind
    $("#btnOpenPdf").addEventListener("click", () => openPdf());
    $("#btnCopyLink").addEventListener("click", () => copyText(location.href).then(()=>toast("Lien copi√©.")));
    $("#btnCopyPost").addEventListener("click", () => copyText($("#shareText").value).then(()=>toast("Post copi√©.")));

    $("#btnShare").addEventListener("click", () => doShare({
      title: document.title,
      text: $("#shareText").value,
      url: location.href
    }));

    $("#btnMakeClip").addEventListener("click", () => {
      $("#shareText").value = makeViralPost();
      toast("Post g√©n√©r√©.");
    });

    $("#btnReveal").addEventListener("click", () => {
      state.wow = !state.wow;
      document.body.style.filter = state.wow ? "saturate(1.08) contrast(1.02)" : "";
      toast(state.wow ? "Mode WOW: ON" : "Mode WOW: OFF");
      // micro ‚Äúwow‚Äù: secoue un peu le ticker
      $("#marq").style.animationDuration = state.wow ? "18s" : "30s";
    });

    $("#btnStart").addEventListener("click", () => {
      openModal("Pitch (copier-coller)", "1 min ‚Äî pr√™t √† poster", `
        <div class="content">
          <h3>Pitch (60 secondes)</h3>
          <p><strong>On recrute un profil DG/strat√®ge social¬∑e (anonymis√©)</strong> capable de tenir ensemble gouvernance, terrain et d√©bat public.</p>
          <ul>
            <li><strong>Parcours 360¬∞</strong> : associatif + recherche + direction + action sociale.</li>
            <li><strong>Gouvernance partag√©e</strong> : codirection, partage du pouvoir, robustesse institutionnelle.</li>
            <li><strong>Crise & budgets</strong> : lucidit√©, preuves, cadrage public sans hyst√©rie.</li>
            <li><strong>Doctrine</strong> : dignit√© + participation (‚Äúrien sur moi, sans moi‚Äù).</li>
          </ul>
          <p class="small">Ce site est un dossier anonymis√© + une landing de recrutement.</p>
        </div>
      `, {copy: makeViralPost()});
    });

    $("#btnQuiz").addEventListener("click", () => scrollToId("quiz"));
    $("#btnQuiz2").addEventListener("click", () => scrollToId("quiz"));

    $("#btnCandidater").addEventListener("click", () => {
      openModal("Candidature (email pr√™t)", "Copie/colle et envoie", `
        <div class="content">
          <h3>Email ‚Äî proposition de prise de contact</h3>
          <pre><code>${escapeHtml(makeEmail())}</code></pre>
          <p class="small">‚ö†Ô∏è Conserve l‚Äôanonymat. Ne mets aucune info d‚Äôidentit√© priv√©e ici.</p>
        </div>
      `, {copy: makeEmail(), download: makeKitBlob()});
    });

    $("#btnExport").addEventListener("click", () => {
      downloadBlob(makeKitBlob(), "kit-recrutement-pr-du-lac.zip.txt");
      toast("Kit export√© (texte).");
    });

    $("#btnOnlyProof").addEventListener("click", () => {
      state.onlyProof = !state.onlyProof;
      $("#btnOnlyProof").classList.toggle("primary", state.onlyProof);
      renderFeed();
      renderKPIs();
    });

    $("#btnOnlyBreaking").addEventListener("click", () => {
      state.onlyBreaking = !state.onlyBreaking;
      $("#btnOnlyBreaking").classList.toggle("primary", state.onlyBreaking);
      renderFeed();
      renderKPIs();
    });

    $("#btnReset").addEventListener("click", () => {
      state.onlyProof = false;
      state.onlyBreaking = false;
      state.query = "";
      $("#btnOnlyProof").classList.remove("primary");
      $("#btnOnlyBreaking").classList.remove("primary");
      $("#q").value = "";
      renderFeed();
      renderKPIs();
      toast("Reset.");
    });

    $("#btnClear").addEventListener("click", () => clearViewer());
    $("#btnRedact").addEventListener("click", () => redactViewer());

    $("#q").addEventListener("input", () => { state.query = $("#q").value.trim(); renderFeed(); });
    document.addEventListener("keydown", (e) => { if(e.key==="/" && document.activeElement !== $("#q")){ e.preventDefault(); $("#q").focus(); } });

    // Modal
    const modal = $("#modal");
    $("#mClose").addEventListener("click", closeModal);
    modal.addEventListener("click", (e)=> { if(e.target===modal) closeModal(); });
    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeModal(); });

    // Quiz actions
    $("#btnCopyScore").addEventListener("click", () => copyText(makeScoreText()).then(()=>toast("R√©sultat copi√©.")));
    $("#btnShareScore").addEventListener("click", () => doShare({title:"R√©sultat ‚Äî Fit mission", text: makeScoreText(), url: location.href}));

    // ========= Renderers =========
    function renderChips(){
      const host = $("#chips");
      host.innerHTML = "";
      BRAND_TAGS.forEach(t=>{
        const el = document.createElement("span");
        el.className = "chip";
        el.innerHTML = `<strong>#</strong> ${escapeHtml(t)}`;
        host.appendChild(el);
      });
    }

    function renderKPIs(){
      const stories = filteredStories();
      $("#kStories").textContent = stories.length;
      const tagSet = new Set();
      stories.forEach(s => (s.tags||[]).forEach(t => tagSet.add(t)));
      $("#kTags").textContent = tagSet.size;
      $("#kProof").textContent = stories.filter(s=>s.proof).length;
    }

    function filteredStories(){
      return STORIES
        .filter(s => !state.onlyProof || s.proof)
        .filter(s => !state.onlyBreaking || s.breaking)
        .filter(s => {
          if(!state.query) return true;
          const q = state.query.toLowerCase();
          const blob = [s.title, s.body, (s.tags||[]).join(" "), s.badge].join(" ").toLowerCase();
          return blob.includes(q);
        })
        .sort((a,b)=> b.ts - a.ts);
    }

    function renderFeed(){
      const host = $("#feed");
      host.innerHTML = "";
      const list = filteredStories();

      if(!list.length){
        host.innerHTML = `<div class="notice"><strong>Aucun r√©sultat.</strong> Modifie la recherche ou reset.</div>`;
        return;
      }

      list.forEach(s=>{
        const el = document.createElement("article");
        el.className = "story";
        const badgeClass = s.breaking ? "breaking" : (s.proof ? "proof" : "");
        el.innerHTML = `
          <div class="shd">
            <span class="badge ${badgeClass}">${escapeHtml(s.badge)}</span>
            <div style="min-width:0; flex:1">
              <h3>${escapeHtml(s.title)}</h3>
              <div class="meta">
                <span>${escapeHtml(fmtDate(s.ts))}</span>
                <span>¬∑</span>
                <span>${escapeHtml((s.tags||[]).join(", ") || "‚Äî")}</span>
              </div>
            </div>
          </div>
          <div class="txt">${escapeHtml(truncate(s.body, 320))}</div>
          <div class="actions">
            <button class="btn primary" data-read="${s.id}">Lire</button>
            <button class="btn" data-post="${s.id}">Post</button>
            <button class="btn" data-share="${s.id}">Partager</button>
          </div>
        `;
        el.querySelector(`[data-read="${s.id}"]`).addEventListener("click", ()=> viewStory(s.id));
        el.querySelector(`[data-post="${s.id}"]`).addEventListener("click", ()=>{
          const text = makeViralPost(s);
          openModal("Post pr√™t √† publier", "LinkedIn / Bluesky / Mastodon / X", `
            <div class="content">
              <pre><code>${escapeHtml(text)}</code></pre>
            </div>
          `, {copy: text});
        });
        el.querySelector(`[data-share="${s.id}"]`).addEventListener("click", ()=>{
          const text = makeViralPost(s);
          doShare({title: s.title, text, url: location.href});
        });
        host.appendChild(el);
      });
    }

    function viewStory(id){
      const s = STORIES.find(x=>x.id===id);
      if(!s) return;

      $("#viewTitle").textContent = s.title;
      $("#viewSub").textContent = `${fmtDate(s.ts)} ¬∑ ${s.badge} ¬∑ tags: ${(s.tags||[]).join(", ") || "‚Äî"}`;

      $("#content").innerHTML = `
        <div class="notice"><strong>Story</strong> (d√©riv√©e du dossier anonymis√©) ‚Äî tu peux copier/coller en post.</div>
        <div class="hr"></div>
        <div class="content">
          ${renderMdLite(s.body)}
          <div class="hr"></div>
          <button class="btn primary" id="btnPostHere">Copier post viral</button>
          <button class="btn" id="btnPdfHere">Ouvrir PDF anonymis√©</button>
        </div>
      `;

      $("#btnPostHere").addEventListener("click", ()=> copyText(makeViralPost(s)).then(()=>toast("Post copi√©.")));
      $("#btnPdfHere").addEventListener("click", ()=> openPdf());
    }

    function clearViewer(){
      $("#viewTitle").textContent = "Lecteur";
      $("#viewSub").textContent = "S√©lectionne une story. Ou ouvre le PDF anonymis√©.";
      $("#content").innerHTML = `
        <div class="content">
          <h3>√Ä faire</h3>
          <ul>
            <li>Choisis une story √† gauche</li>
            <li>Ou ouvre le PDF</li>
            <li>Puis g√©n√®re un post / partage / candidater</li>
          </ul>
        </div>
      `;
    }

    function redactViewer(){
      const el = $("#content");
      const txt = el.innerText || "";
      const red = redactText(txt);
      $("#content").innerHTML = `<div class="notice"><strong>Redact</strong> (best effort). V√©rifie manuellement.</div>
      <div class="hr"></div><pre><code>${escapeHtml(red)}</code></pre>`;
      toast("Redact appliqu√©.");
    }

    // ========= PDF =========
    function openPdf(){
      // Embed via <iframe>. Sur GitHub Pages: OK. En local: OK.
      openModal("PDF anonymis√©", PDF_PATH, `
        <iframe class="embed" src="${escapeHtml(PDF_PATH)}" title="PDF anonymis√©"></iframe>
        <div class="small" style="margin-top:10px">
          Si le PDF ne s‚Äôaffiche pas, v√©rifie qu‚Äôil s‚Äôappelle <span class="mono">anonymised.pdf</span> et qu‚Äôil est dans le m√™me dossier que <span class="mono">index.html</span>.
        </div>
      `, {downloadUrl: PDF_PATH});
    }

    // ========= Quiz =========
    function renderQuiz(){
      const host = $("#quiz");
      host.innerHTML = "";
      state.score = 0;
      $("#scoreN").textContent = "0";

      QUIZ.forEach((item, idx)=>{
        const card = document.createElement("div");
        card.className = "q";
        card.innerHTML = `
          <strong>${idx+1}. ${escapeHtml(item.q)}</strong>
          <div class="opt"></div>
        `;
        const opt = card.querySelector(".opt");
        item.opts.forEach((o)=>{
          const b = document.createElement("button");
          b.textContent = o.t;
          b.addEventListener("click", ()=>{
            state.score += o.v;
            $("#scoreN").textContent = String(state.score);
            toast(o.v>=2 ? "‚úÖ Excellent choix" : (o.v===1 ? "üü® OK" : "üü• Pas align√©"));
            // disable this question choices after one click
            Array.from(opt.querySelectorAll("button")).forEach(x=>x.disabled=true);
            b.style.borderColor = o.v>=2 ? "rgba(61,240,168,.55)" : (o.v===1 ? "rgba(255,204,102,.55)" : "rgba(255,92,122,.55)");
          });
          opt.appendChild(b);
        });
        host.appendChild(card);
      });
    }

    function makeScoreText(){
      const tier = state.score >= 6 ? "FIT FORT" : (state.score >= 3 ? "FIT MOYEN" : "FIT FAIBLE");
      return `R√©sultat ‚Äúfit mission‚Äù: ${tier} ‚Äî score=${state.score}/8. Site recrutement anonymis√©: ${location.href}`;
    }

    // ========= Viral content =========
    function makeViralPost(story=null){
      const base = story ? `üß© ${story.title}\n\n${story.body}\n\n` :
        `On recrute un profil DG / strat√®ge social¬∑e (anonymis√©).\n\n`;
      const punch =
`üîé Pourquoi c‚Äôest rare :
‚Ä¢ Gouvernance partag√©e + robustesse institutionnelle
‚Ä¢ Terrain + urgence sociale + dignit√©
‚Ä¢ D√©bat public sans hyst√©rie
‚Ä¢ Alliances & plaidoyer

üß™ Fais le mini-quiz sur la page et partage ton r√©sultat.

#recrutement #social #gouvernance #educationpermanente #Bruxelles`;
      return cleanForPost(base + punch);
    }

    function makeEmail(){
      return `Objet : Proposition de contact ‚Äî recrutement (profil DG/strat√®ge social¬∑e anonymis√©)

Bonjour,

Nous avons construit un dossier anonymis√© (preuves + timeline + synth√®se) et une landing de recrutement.

Ce que nous recherchons :
- direction/gouvernance robuste en contexte public,
- capacit√© √† articuler vision + terrain,
- communication en p√©riode de tension,
- et une ligne √©thique centr√©e sur la dignit√© et la participation.

Nous souhaitons proposer un premier √©change (30‚Äì45 min) pour valider un ‚Äúfit mission‚Äù.
Lien du dossier : ${location.href}

Bien √† vous,`;
    }

    // Export ‚Äúkit‚Äù (texte) ‚Äî simple et compatible
    function makeKitBlob(){
      const text =
`KIT RECRUTEMENT ‚Äî Pr. du Lac (anonymis√©)
=====================================

1) Pitch:
${makeViralPost()}

2) Email:
${makeEmail()}

3) Stories:
${STORIES.map(s=>`- ${new Date(s.ts).toISOString()} [${s.badge}] ${s.title}\n  tags: ${(s.tags||[]).join(", ")}\n  ${s.body}\n`).join("\n")}

4) Quiz:
Score actuel: ${state.score}/8

Note √©thique:
- Ne pas publier de donn√©es d‚Äôidentit√© priv√©e.
- Ce site ne contient que du profil anonymis√©.

PDF attendu: ${PDF_PATH}
`;
      return new Blob([text], {type:"text/plain;charset=utf-8"});
    }

    // ========= Modal =========
    let modalCopyPayload = null;
    let modalDownloadPayload = null;

    function openModal(title, sub, html, opts={}){
      $("#mTitle").textContent = title;
      $("#mSub").textContent = sub || "";
      $("#mBody").innerHTML = html || "";
      $("#modal").classList.add("open");

      modalCopyPayload = opts.copy || null;

      // download: either Blob or URL
      modalDownloadPayload = null;
      if(opts.download instanceof Blob) modalDownloadPayload = {blob: opts.download, filename: opts.filename || "download.txt"};
      if(opts.downloadUrl) modalDownloadPayload = {url: opts.downloadUrl, filename: opts.filename || inferName(opts.downloadUrl)};
      if(opts.download && !(opts.download instanceof Blob)) modalDownloadPayload = {blob: opts.download, filename: opts.filename || "download.txt"};

      $("#mCopy").disabled = !modalCopyPayload;
      $("#mDownload").disabled = !modalDownloadPayload;

      $("#mCopy").onclick = () => {
        if(!modalCopyPayload) return;
        copyText(modalCopyPayload).then(()=>toast("Copi√©."));
      };

      $("#mDownload").onclick = () => {
        if(!modalDownloadPayload) return;
        if(modalDownloadPayload.blob){
          downloadBlob(modalDownloadPayload.blob, modalDownloadPayload.filename);
          toast("T√©l√©charg√©.");
        }else if(modalDownloadPayload.url){
          // simple link download
          const a = document.createElement("a");
          a.href = modalDownloadPayload.url;
          a.download = modalDownloadPayload.filename;
          document.body.appendChild(a);
          a.click();
          a.remove();
        }
      };
    }

    function closeModal(){
      $("#modal").classList.remove("open");
      $("#mBody").innerHTML = "";
      modalCopyPayload = null;
      modalDownloadPayload = null;
      $("#mCopy").onclick = null;
      $("#mDownload").onclick = null;
    }

    $("#mClose").addEventListener("click", closeModal);

    // ========= Share =========
    async function doShare({title, text, url}){
      try{
        if(navigator.share){
          await navigator.share({title, text, url});
          toast("Partag√©.");
          return;
        }
      }catch(e){ /* ignored */ }
      // fallback: copy post
      const fallback = `${text}\n\n${url}`;
      await copyText(fallback);
      toast("Partage non dispo ‚Äî texte copi√©.");
    }

    // ========= Helpers =========
    function uid(){ return Math.random().toString(36).slice(2,10) + "-" + Date.now().toString(36); }

    function fmtDate(ts){
      const d = new Date(ts);
      return d.toLocaleString(undefined, {year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});
    }

    function truncate(s, n){
      s = String(s||"").trim();
      if(s.length <= n) return s;
      return s.slice(0, n-1).trim() + "‚Ä¶";
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, c => ({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[c]));
    }

    function renderMdLite(md){
      // super simple markdown-ish renderer (safe)
      const lines = String(md||"").replace(/\r\n/g,"\n").split("\n");
      let html = "", inList = false;
      const flushList = ()=>{ if(inList){ html += "</ul>"; inList=false; } };
      for(const line of lines){
        const t = line.trim();
        if(!t){ flushList(); continue; }
        if(t.startsWith("### ")){ flushList(); html += `<h3>${escapeHtml(t.slice(4))}</h3>`; continue; }
        if(t.startsWith("## ")){ flushList(); html += `<h3>${escapeHtml(t.slice(3))}</h3>`; continue; }
        if(t.startsWith("# ")){ flushList(); html += `<h3>${escapeHtml(t.slice(2))}</h3>`; continue; }
        const mL = t.match(/^[-*]\s+(.*)$/);
        if(mL){
          if(!inList){ html += "<ul>"; inList=true; }
          html += `<li>${escapeHtml(mL[1])}</li>`;
          continue;
        }
        flushList();
        html += `<p>${escapeHtml(line)}</p>`;
      }
      flushList();
      return html;
    }

    function redactText(text){
      let t = String(text||"");
      t = t.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/ig, "[email masqu√©]");
      t = t.replace(/\b(\+?\d[\d\s().-]{7,}\d)\b/g, "[num√©ro masqu√©]");
      return t;
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(String(text));
      }catch(e){
        // fallback
        const ta = document.createElement("textarea");
        ta.value = String(text);
        ta.style.position="fixed"; ta.style.left="-9999px";
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        ta.remove();
      }
    }

    function downloadBlob(blob, filename){
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename || "download.txt";
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 900);
    }

    function inferName(url){
      try{ return new URL(url, location.href).pathname.split("/").pop() || "download"; }
      catch{ return "download"; }
    }

    function toast(msg){
      const n = document.createElement("div");
      n.textContent = msg;
      n.style.position = "fixed";
      n.style.left = "50%";
      n.style.bottom = "16px";
      n.style.transform = "translateX(-50%)";
      n.style.padding = "10px 12px";
      n.style.borderRadius = "14px";
      n.style.background = "rgba(10,14,26,.82)";
      n.style.border = "1px solid rgba(255,255,255,.12)";
      n.style.boxShadow = "0 18px 60px rgba(0,0,0,.45)";
      n.style.color = "var(--text)";
      n.style.fontSize = "12px";
      n.style.zIndex = "600";
      n.style.backdropFilter = "blur(12px)";
      document.body.appendChild(n);
      setTimeout(()=>{ n.style.opacity="0"; n.style.transition="opacity .25s ease"; }, 1400);
      setTimeout(()=> n.remove(), 1750);
    }

    function cleanForPost(text){
      // remove excessive whitespace
      return String(text||"")
        .replace(/[ \t]+\n/g, "\n")
        .replace(/\n{3,}/g, "\n\n")
        .trim();
    }

    function scrollToId(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({behavior:"smooth", block:"start"});
    }
  })();
  </script>
</body>
</html>
